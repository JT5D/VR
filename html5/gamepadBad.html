<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
    <title>Gamepad, good</title>
</head>
<body onload="controllerTest()">
    <div id="output"></div>
    <script>
        function controllerTest() {
            "use strict";
            var output = document.getElementById("output"),
                pad = null,
                frame = 0, i;

            function getPad() {
                if (!pad) {
                    var pads = navigator.getGamepads();
                    for (i = 0; i < pads.length; ++i) {
                        if (pads[i] && confirm("Use this gamepad? " + pads[i].id)) {
                            pad = pads[i];
                        }
                    }
                }
                return pad;
            }

            function loop(dt) {
                requestAnimationFrame(loop);
                var pad = getPad(),
                    buttonInfo = [],
                    axisInfo = [];
                
                if(pad){
                    for (i = 0; i < pad.buttons.length; ++i) {
                        if (pad.buttons[i].pressed) {
                            buttonInfo.push(i);
                        }
                    }
                    for (i = 0; i < pad.axes.length; ++i) {
                        axisInfo.push("[" + i + ": " + pad.axes[i] + "]");
                    }
                }
                output.innerHTML = "frame: " + (frame++) +
                    "<br>buttons: " + buttonInfo.join(" -- ") +
                    "<br>axes: " + axisInfo.join(" -- ");
            }

            requestAnimationFrame(loop);
        }
    </script>
</body>

</html>